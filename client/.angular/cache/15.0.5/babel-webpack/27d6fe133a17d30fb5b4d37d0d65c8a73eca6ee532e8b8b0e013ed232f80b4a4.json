{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../../prodshopmod.service\";\nimport * as i3 from \"ngx-toastr\";\nimport * as i4 from \"@angular/material/dialog\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"../../../Account/text-inputs/text-inputs.component\";\nfunction ItemsComponent_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵelement(1, \"input\", 19);\n    i0.ɵɵelementStart(2, \"label\", 20);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const brand_r3 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.productForm);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"id\", brand_r3.id);\n    i0.ɵɵpropertyInterpolate(\"value\", brand_r3.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"for\", brand_r3.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(brand_r3.name);\n  }\n}\nfunction ItemsComponent_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵelement(1, \"input\", 21);\n    i0.ɵɵelementStart(2, \"label\", 20);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const type_r4 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.productForm);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"id\", type_r4.id);\n    i0.ɵɵpropertyInterpolate(\"value\", type_r4.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"for\", type_r4.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(type_r4.name);\n  }\n}\nfunction ItemsComponent_ul_25_li_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const error_r6 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", error_r6, \" \");\n  }\n}\nfunction ItemsComponent_ul_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\", 22);\n    i0.ɵɵtemplate(1, ItemsComponent_ul_25_li_1_Template, 2, 1, \"li\", 23);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIfOf\", ctx_r2.errors);\n  }\n}\nexport class ItemsComponent {\n  constructor(formbuilder, productsService, toastr, matdialog, prodshopmodService) {\n    this.formbuilder = formbuilder;\n    this.productsService = productsService;\n    this.toastr = toastr;\n    this.matdialog = matdialog;\n    this.prodshopmodService = prodshopmodService;\n    this.errors = null;\n    this.brands = [];\n    this.types = [];\n    this.prodName = [];\n    this.prodBrand = [];\n    this.prodType = [];\n    this.prodPictureUrl = \"\";\n    this.formdata = null;\n    this.productForm = this.formbuilder.group({\n      prodName: ['', Validators.required],\n      prodPicture: ['', Validators.required],\n      prodDescription: ['', Validators.required],\n      prodPrice: ['', Validators.required],\n      productBrandId: ['', Validators.required],\n      productTypeId: ['', Validators.required]\n    });\n  }\n  ngOnInit() {\n    this.GetProductBrands();\n    this.GetProductTypes();\n    this.GetProducts();\n  }\n  onSubmit() {\n    this.productsService.saveProductPicture(this.formdata).subscribe({\n      next: () => {\n        this.toastr.success(\"Picture saved\");\n        this.sendData();\n      },\n      error: error => {\n        this.toastr.success(\"Picture not saved\");\n        this.errors = error.errors;\n      }\n    });\n  }\n  sendData() {\n    const findName = this.prodName.find(x => x.toLowerCase() === this.productForm?.get('prodName')?.value.toLowerCase());\n    const findPrice = this.prodType.find(x => x === this.productForm?.get('prodPrice')?.value);\n    if (findName && findPrice) {\n      this.toastr.success(\"Product already exist\");\n    } else {\n      this.productsService.UploadProduct(this.productForm.value).subscribe({\n        next: () => {\n          window.location.reload();\n          this.toastr.success(\"Product uploaded\");\n        },\n        error: error => {\n          this.toastr.success(\"Not uploaded\");\n          this.errors = error.errors;\n        }\n      });\n    }\n  }\n  closeDialog() {\n    this.matdialog.closeAll(); // <- Close the mat dialog\n  }\n\n  GetProducts() {\n    this.prodshopmodService.getProducts().subscribe({\n      next: response => {\n        for (let x of response.data) {\n          this.prodName.push(x.prodName);\n          this.prodBrand.push(x.productBrand);\n          this.prodType.push(x.productType);\n        }\n      },\n      error: error => console.log(error)\n    });\n  }\n  GetProductBrands() {\n    this.prodshopmodService.getBrands().subscribe({\n      next: brands => {\n        this.brands = brands;\n      },\n      error: error => console.log(error)\n    });\n  }\n  GetProductTypes() {\n    this.prodshopmodService.getProductTypes().subscribe({\n      next: types => {\n        this.types = types;\n      },\n      error: error => console.log(error)\n    });\n  }\n  uploadPicture(e) {\n    if (e.target.files.length > 0) {\n      const file = e.target.files[0];\n      var formData = new FormData();\n      formData.append('myFiles', file);\n      this.formdata = formData;\n    }\n  }\n}\nItemsComponent.ɵfac = function ItemsComponent_Factory(t) {\n  return new (t || ItemsComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.ProdshopmodService), i0.ɵɵdirectiveInject(i3.ToastrService), i0.ɵɵdirectiveInject(i4.MatDialog), i0.ɵɵdirectiveInject(i2.ProdshopmodService));\n};\nItemsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ItemsComponent,\n  selectors: [[\"app-items\"]],\n  decls: 30,\n  vars: 15,\n  consts: [[2, \"background-color\", \"lightgray\", \"padding-bottom\", \"40px\", \"border\", \"5px solid skyblue\"], [1, \"align-content-left\"], [1, \"btn\", \"btn-danger\", 2, \"margin-top\", \"15px\", \"margin-left\", \"5px\", 3, \"click\"], [1, \"text-center\", 2, \"color\", \"blue\"], [1, \"d-flex\", \"justify-content-center\"], [1, \"col-3\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"text-center\", \"mt-5\"], [3, \"formControl\", \"label\"], [3, \"formControl\", \"type\", \"label\", \"change\"], [3, \"formControl\", \"type\", \"label\"], [1, \"row\"], [1, \"col-6\"], [2, \"font-weight\", \"bolder\"], [\"class\", \"d-flex\", 3, \"formGroup\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"text-danger list-unstyled\", 4, \"ngIf\"], [1, \"d-grid\"], [\"type\", \"submit\", 1, \"btn\", \"btn-lg\", \"btn-success\", 2, \"margin-top\", \"10px\", 3, \"disabled\"], [1, \"d-flex\", 3, \"formGroup\"], [\"formControlName\", \"productBrandId\", \"name\", \"productBrandId\", \"type\", \"radio\", 3, \"id\", \"value\"], [3, \"for\"], [\"formControlName\", \"productTypeId\", \"name\", \"productTypeId\", \"type\", \"radio\", 3, \"id\", \"value\"], [1, \"text-danger\", \"list-unstyled\"], [4, \"ngIf\", \"ngIfOf\"]],\n  template: function ItemsComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function ItemsComponent_Template_button_click_2_listener() {\n        return ctx.closeDialog();\n      });\n      i0.ɵɵtext(3, \" x \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(4, \"div\", 3)(5, \"h1\");\n      i0.ɵɵtext(6, \"Product Upload Page\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(7, \"div\", 4)(8, \"div\", 5)(9, \"form\", 6);\n      i0.ɵɵlistener(\"ngSubmit\", function ItemsComponent_Template_form_ngSubmit_9_listener() {\n        return ctx.onSubmit();\n      });\n      i0.ɵɵelementStart(10, \"div\", 7);\n      i0.ɵɵelement(11, \"app-text-inputs\", 8);\n      i0.ɵɵelementStart(12, \"app-text-inputs\", 9);\n      i0.ɵɵlistener(\"change\", function ItemsComponent_Template_app_text_inputs_change_12_listener($event) {\n        return ctx.uploadPicture($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(13, \"app-text-inputs\", 8)(14, \"app-text-inputs\", 10);\n      i0.ɵɵelementStart(15, \"div\", 11)(16, \"div\", 12)(17, \"strong\", 13);\n      i0.ɵɵtext(18, \" Brand\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(19, ItemsComponent_div_19_Template, 4, 5, \"div\", 14);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"div\", 12)(21, \"strong\", 13);\n      i0.ɵɵtext(22, \"Type\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(23, ItemsComponent_div_23_Template, 4, 5, \"div\", 14);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(24, \"div\");\n      i0.ɵɵtemplate(25, ItemsComponent_ul_25_Template, 2, 1, \"ul\", 15);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(26, \"br\");\n      i0.ɵɵelementStart(27, \"div\", 16)(28, \"button\", 17);\n      i0.ɵɵtext(29, \" Upload Product \");\n      i0.ɵɵelementEnd()()()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"formGroup\", ctx.productForm);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"formControl\", ctx.productForm.controls[\"prodName\"])(\"label\", \"Product Name\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"formControl\", ctx.productForm.controls[\"prodPicture\"])(\"type\", \"file\")(\"label\", \"Product Picture\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"formControl\", ctx.productForm.controls[\"prodDescription\"])(\"label\", \"Product Description\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"formControl\", ctx.productForm.controls[\"prodPrice\"])(\"type\", \"number\")(\"label\", \"Price\");\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngForOf\", ctx.brands);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.types);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.errors);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"disabled\", ctx.productForm.invalid);\n    }\n  },\n  dependencies: [i5.NgForOf, i5.NgIf, i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.RadioControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormControlDirective, i1.FormGroupDirective, i1.FormControlName, i6.TextInputsComponent]\n});","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}